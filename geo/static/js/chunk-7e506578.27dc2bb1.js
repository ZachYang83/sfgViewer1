(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7e506578"],{"1da4":function(e,t,n){},"350e":function(e,t,n){},4853:function(e,t,n){},"5b13":function(e,t,n){"use strict"},7714:function(e,t,n){"use strict";n("1da4")},"85d2":function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("Legend",{staticStyle:{bottom:"20px",left:"10px",width:"200px",height:"auto"},attrs:{title:e.title,items:e.items}}),n("div",{staticClass:"timeLine"},[n("Timeline",{on:{changeData:e.changeLayer}})],1),n("div",{directives:[{name:"show",rawName:"v-show",value:e.showData,expression:"showData"}],staticClass:"dataPan",class:{active:e.showData}},[n("div",{staticClass:"item changzhu"},[e._m(0),n("div",{staticClass:"content"},[n("keep-alive",[n(e.isChangzhu,{ref:"changzhu_pan",tag:"component",attrs:{datas:e.changzhu}})],1)],1)])])],1)},o=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"title"},[n("h2",[e._v("常驻人口")])])}],i=n("8c93"),s=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"timeline"}},[n("div",{ref:"timeline-table",staticClass:"timeline-table"})])},r=[],c=n("313e");let l={timeline:{axisType:"category",lineStyle:{show:!0},symbol:"circle",itemStyle:{normal:{color:"rgba(194,53,49, 0.5)"}},controlStyle:{showPrevBtn:!0,showNextBtn:!0,normal:{color:"rgba(194,53,49, 0.5)",borderColor:"rgba(194,53,49, 0.5)"}},orient:"horizontal",inverse:!1,x:0,x2:0,y:0,width:"100%",height:"80%",loop:!1,autoPlay:!1,playInterval:1e3,realtime:!0},baseOption:{tooltip:{trigger:"axis"}}};class h{constructor(){this.chart=void 0,this.lastIndex=0}static makeTimeline(e,t,n){let a=new h,o=t.timeline.data.length,i=c["util"].merge(l,t,!0);i=i||{},a.chart=c["init"](e,null,{}),a.chart.on("timelineChanged",e=>{let t=a.lastIndex,i=e.currentIndex;console.log("last index:"+t+",current index:"+i),0!==o?t!=i?(a.lastIndex=i,console.log("move "+t+" to "+i),n.callback(a,e)):t===i&&(0===t?n.last(a,e):n.next(a,e)):console.log("no data.")}),a.chart.setOption(i)}update(e){let t=c["util"].merge(l,e,!0),n=t.timeline.currentIndex;this.chart.setOption(t),this.lastIndex=void 0!=n?n:0}}var u={name:"Timeline",data(){return{}},mounted:function(){let e=this,t=this.$refs["timeline-table"],n=this,a={timeline:{data:[202201,202202,202203,202204,202205,202206,202207,202208,202209,202210],label:{formatter:function(e){return e}}}},o=[1,20],i={callback:(t,n)=>{let a=n.currentIndex;e.changeData(a)},last:(e,t)=>{let i=t.currentIndex;if(curPage>o[0]){curPage-=1,a.timeline.data=n.getDataJson(start,len,-1);let t=a.timeline.data.length-1;a.timeline.currentIndex=t,e.update(a),start-=len}console.log("-curPage:"+curPage+",curIndex:"+i)},next:(e,t)=>{let i=t.currentIndex;curPage<o[1]&&(curPage+=1,a.timeline.data=n.getDataJson(start,len,1),a.timeline.currentIndex=0,e.update(a),start+=len),console.log("+curPage:"+curPage+",curIndex:"+i)}};h.makeTimeline(t,a,i)},methods:{changeData(e){console.log("子组件");let t=[202201,202202,202203,202204,202205,202206,202207,202208,202209,202210];this.$parent.changeLayer(e,t[e])}}},g=u,d=(n("d66e"),n("2877")),m=Object(d["a"])(g,s,r,!1,null,"0f4e86be",null),y=m.exports,f=n("e624"),p=(n("5b13"),n("b21f")),b=n("b775");function x(e,t){return Object(b["a"])({url:e,method:"get",params:t})}var w=function(){var e=this,t=e.$createElement;e._self._c;return e._m(0)},v=[function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"changzhu"}},[n("div",{attrs:{id:"city_pan"}}),n("div",{attrs:{id:"county_pan"}})])}];let _,z;var F={name:"cz_chart",props:{datas:{type:Object,default:()=>({})}},mounted(){var e=document.getElementById("city_pan");_=echarts.init(e);var t=document.getElementById("county_pan");z=echarts.init(t)},methods:{setChart(e){let t=this;this.$nextTick(()=>{_.resize(),z.resize()});let n=e.shiData;n.sort((e,t)=>e.pop-t.pop);let a=[],o=[];n.forEach(e=>{o.push(e.city),a.push(e.pop)});let i={title:{left:"center",text:"各市"+t.datas.month.toString().slice(-2)+"月常驻人口",textStyle:{color:"#BDBDBD"}},tooltip:{trigger:"item",formatter:"{b}:{c}"},grid:{x:50,y:30,y2:30},xAxis:{type:"value",boundaryGap:[0,.02],splitLine:{show:!1},axisLabel:{show:!0},axisLine:{show:!0,lineStyle:{color:"#00FFFF"}},axisTick:{show:!1}},yAxis:{type:"category",data:o,splitLine:{show:!1},axisLabel:{textStyle:{color:"#00FFFF"},interval:0},axisLine:{show:!0,lineStyle:{color:"#00FFFF"}}},color:"#00FFFF",series:[{type:"bar",data:a,itemStyle:{normal:{label:{show:!0,position:"right",textStyle:{color:"#00FFFF",fontSize:10}}}}}]};_.setOption(i,!0);let s=e.monthdata,r={title:{left:"center",text:t.datas.county+"各月常驻人口",textStyle:{color:"#BDBDBD"}},tooltip:{trigger:"item",formatter:"{b}:{c}"},grid:{x:50,y:50,y2:30},yAxis:{type:"value",boundaryGap:[0,.02],splitLine:{show:!1},axisLabel:{show:!0},axisLine:{show:!0,lineStyle:{color:"#00FFFF"}},axisTick:{show:!1}},xAxis:{type:"category",data:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月"],splitLine:{show:!1},axisLabel:{textStyle:{color:"#00FFFF"},interval:0},axisLine:{show:!0,lineStyle:{color:"#00FFFF"}}},color:"#00FFFF",series:[{type:"bar",data:s,itemStyle:{normal:{label:{show:!0,position:"top",textStyle:{color:"#00FFFF",fontSize:10}}}}}]};z.setOption(r,!0)}}},P=F,C=(n("c5fc"),Object(d["a"])(P,w,v,!1,null,"2f503de6",null)),k=C.exports;let L;var S={data(){return{layerProp:{city:"广州",month:202201,county:""},changzhu:{},showData:!1,isChangzhu:"Chart",title:"常驻人口（万人）",items:[{index:1,text:"0 - 25",style:"backgroundColor:rgb(255,247,242)"},{index:2,text:"25 - 50",style:"backgroundColor:rgb(252,206,202)"},{index:3,text:"50 - 100",style:"backgroundColor:rgb(250,150,178)"},{index:4,text:"100 - 250",style:"backgroundColor:rgb(227,64,153)"},{index:5,text:"250 - 500",style:"backgroundColor:rgb(153,0,122)"}]}},components:{Legend:i["a"],Timeline:y,Chart:k},mounted(){this.init(),this.loadWMS(),this.mouseEvent()},methods:{init(){window.MAP.getCanvas().style.cursor="pointer",Object(f["a"])(window.MAP,[113.35,22.9],6.5)},loadWMS(){window.MAP.addSource("sfg_changzhu",{type:"vector",scheme:"tms",tiles:["https://zwfw.credit.gdgov.cn/geoserver/gwc/service/tms/1.0.0/gpzi%3Asfg_changzhu@EPSG%3A900913@pbf/{z}/{x}/{y}.pbf"]}),window.MAP.addLayer({id:"sfg_changzhu",source:"sfg_changzhu","source-layer":"sfg_changzhu",type:"fill",paint:{"fill-outline-color":"#455a64","fill-color":["case",["<",["get","1mon"],25],"rgb(255,247,242)",["<",["get","1mon"],50],"rgb(252,206,202)",["<",["get","1mon"],100],"rgb(250,150,178)",["<",["get","1mon"],250],"rgb(227,64,153)",["<",["get","1mon"],500],"rgb(153,0,122)","rgb(73,0,107)"]}}),window.MAP.addLayer({id:"sfg_changzhu_sym",source:"sfg_changzhu","source-layer":"sfg_changzhu",type:"symbol",layout:{"icon-image":"","text-field":"{county}\n{1mon}","text-size":12,"text-anchor":"top"}}),window.MAP.addLayer({id:"sfg_changzhu-hl",type:"line",source:"sfg_changzhu","source-layer":"sfg_changzhu",paint:{"line-color":"#18ffff","line-width":3},filter:["in","county",""]})},changeLayer(e,t){var n,a;switch(e){case 0:n="1mon",a="{county}\n{1mon}";break;case 1:n="2mon",a="{county}\n{2mon}";break;case 2:n="3mon",a="{county}\n{3mon}";break;case 3:n="4mon",a="{county}\n{4mon}";break;case 4:n="5mon",a="{county}\n{5mon}";break;case 5:n="6mon",a="{county}\n{6mon}";break;case 6:n="7mon",a="{county}\n{7mon}";break;case 7:n="8mon",a="{county}\n{8mon}";break;case 8:n="9mon",a="{county}\n{9mon}";break;case 9:n="10mon",a="{county}\n{10mon}";break}var o={"fill-outline-color":"#455a64","fill-color":["case",["<",["get",n],25],"rgb(255,247,242)",["<",["get",n],50],"rgb(252,206,202)",["<",["get",n],100],"rgb(250,150,178)",["<",["get",n],250],"rgb(227,64,153)",["<",["get",n],500],"rgb(153,0,122)","rgb(73,0,107)"]},i={"icon-image":"","text-field":a,"text-size":12,"text-anchor":"top"};window.MAP.removeLayer("sfg_changzhu"),window.MAP.addLayer({id:"sfg_changzhu",source:"sfg_changzhu","source-layer":"sfg_changzhu",type:"fill",paint:o}),window.MAP.removeLayer("sfg_changzhu_sym"),window.MAP.addLayer({id:"sfg_changzhu_sym",source:"sfg_changzhu","source-layer":"sfg_changzhu",type:"symbol",layout:i}),window.MAP.removeLayer("sfg_changzhu-hl"),window.MAP.addLayer({id:"sfg_changzhu-hl",source:"sfg_changzhu","source-layer":"sfg_changzhu",type:"line",paint:{"line-color":"#18ffff","line-width":3},filter:["in","county",""]}),this.layerProp.month=t,this.getData()},mouseEvent(){let e=this;window.MAP.on("click",e.getInfo)},getInfo(e){let t=this;var n=window.MAP.queryRenderedFeatures(e.point);if("sfg_changzhu"==n[0].layer.id){var a=n[0].properties;L=[a["1mon"],a["2mon"],a["3mon"],a["4mon"],a["5mon"],a["6mon"],a["7mon"],a["8mon"],a["9mon"],a["10mon"]],t.changzhu.monthdata=L,window.MAP.setFilter("sfg_changzhu-hl",["in","county",n[0].properties.county])}t.layerProp.city=a.city,t.layerProp.county=a.county,this.getData()},getData(){let e=this;x("/shengfagai/changzhu-shi/getChangzhu",{month:e.layerProp.month}).then(t=>{e.changzhu.shiData=t.data.data,e.changzhu.month=e.layerProp.month,e.changzhu.county=e.layerProp.county,e.showData=!0,e.$refs["changzhu_pan"].setChart(e.changzhu)})}},destroyed(){let e=this;Object(p["a"])(window.MAP,["sfg_changzhu-hl","sfg_changzhu_sym","sfg_changzhu"]),window.MAP.off("click",e.getInfo)}},A=S,D=(n("c93c"),Object(d["a"])(A,a,o,!1,null,"3d0190a7",null));t["default"]=D.exports},"8c93":function(e,t,n){"use strict";var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{ref:"legendClass",staticClass:"legendClass"},[e.isFold?n("div",{staticClass:"foldState",on:{click:e.unShowData}},[n("span",[e._v(e._s(e.title))])]):n("div",{staticClass:"showState"},[n("div",{staticClass:"head",on:{click:e.unShowData}},[n("span",{staticClass:"title"},[n("span",[e._v(e._s(e.title))])])]),n("div",{staticClass:"body"},[e._l(e.items,(function(t){return[n("li",{key:t.key,staticClass:"legendItem",attrs:{index:t.index}},[n("div",{staticClass:"color",style:t.style}),n("div",{staticClass:"legendText",style:e.legentText},[e._v(e._s(t.text))])])]}))],2)])])},o=[],i={name:"legendClass",props:{title:{default:null},items:{default:Array},legentText:{default:null}},data(){return{isFold:!1}},methods:{unShowData(){this.isFold=!this.isFold}}},s=i,r=(n("7714"),n("2877")),c=Object(r["a"])(s,a,o,!1,null,"1f0ae8ec",null);t["a"]=c.exports},b21f:function(e,t,n){"use strict";function a(e,t){t.forEach(t=>{e.getLayer(t)&&e.removeLayer(t),e.getSource(t)&&e.removeSource(t)})}n.d(t,"a",(function(){return a}))},b775:function(e,t,n){"use strict";var a=n("bc3a"),o=n.n(a),i=n("5c96");const s=o.a.create({baseURL:"https://zwfw.credit.gdgov.cn/yxjc/geo-api/"});s.interceptors.request.use(e=>e,e=>(console.log(e),Promise.reject(e))),s.interceptors.response.use(e=>200===e.status?Promise.resolve(e):Promise.reject(e),e=>(console.log("err"+e),Object(i["Message"])({message:e.message,type:"error",duration:1e4}),Promise.reject(e))),t["a"]=s},bc31:function(e,t,n){},c5fc:function(e,t,n){"use strict";n("350e")},c93c:function(e,t,n){"use strict";n("bc31")},d66e:function(e,t,n){"use strict";n("4853")},e624:function(e,t,n){"use strict";function a(e,t,n,a=0){e.setCenter(t),e.setZoom(n),e.setPitch(a)}n.d(t,"a",(function(){return a}))}}]);
//# sourceMappingURL=chunk-7e506578.27dc2bb1.js.map